{% extends 'base.html' %}
{% load static %}
{% block title %} Envoyer-Copies {% endblock %}

{% block content %}
<aside id="sidebar" class="sidebar">

    <ul class="sidebar-nav" id="sidebar-nav">

        <li class="nav-item">
            <a class="nav-link collapsed" href="{% url 'ScolaritePersonal:index' %}">
                <i class="bi bi-grid"></i>
                <span>Dashboard</span>
            </a>
        </li><!-- End Dashboard Nav -->

        <li class="nav-item">
            <a class="nav-link collapsed" href="{% url 'Authentification:login' %}">
                <i class="bi bi-house-check"></i>
                <span>Accueil</span>
            </a>
        </li><!-- End Components Nav -->

        <li class="nav-item">
            <a class="nav-link collapsed" href="{% url 'ScolaritePersonal:envoyer' %}">
                <i class="bi bi-files"></i>
                <span>Envoyer|Enseignant</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link collapsed" href="{% url 'ScolaritePersonal:send_student' %}">
                <i class="bi bi-files"></i>
                <span>Envoyer|Etudiant</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link collapsed" href="{% url 'ScolaritePersonal:copie_envoyee' %}">
                <i class="bi bi-files"></i>
                <span>Copies envoyées</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link collapsed" href="{% url 'ScolaritePersonal:copie_corrigee' %}">
                <i class="bi bi-files"></i>
                <span>Copies corrigées</span>
            </a>
        </li><!-- End Forms Nav -->

        <li class="nav-heading">Pages</li>

        <li class="nav-item">
            <a class="nav-link collapsed" href="{% url 'ScolaritePersonal:Profil' %}">
                <i class="bi bi-person"></i>
                <span>Mon Profil</span>
            </a>
        </li><!-- End Profile Page Nav -->

    </ul>

</aside><!-- End Sidebar-->

<main id="main" class="main">
    <div class="pagetitle">
        <h6><span class="d-none d-lg-block">Gestion de copies d'étudiants de l'Université Norbert ZONGO</span></h6>
        
        <h1>Scolarite de l'UFR-ST</h1>
        <nav>
            
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'ScolaritePersonal:index' %}">Home</a></li>
                <li class="breadcrumb-item active">Dashboard-Scolarite</li>
            </ol>
        </nav>
    </div><!-- End Page Title -->

        <section class="section profile">
            <div class="container mt-5">
                <div class="container mt-5">
                    <h2> Envoyer une évaluation</h2>
                    {% comment %} <form class=" p-4 shadow" style="width: 80%;">
                        <div class="mb-3">
                            <label for="nom" class="form-label">Fillière</label>
                            <input type="text" name="Matriclue" class="form-control" id="nom" required>
                        </div>

                        <div class="mb-3">
                            <label for="mail" class="form-label">Promotion</label>
                            <input type="email" name="mail" class="form-control" id="mail" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="siege" class="form-label">Module</label>
                            <input type="text" name="siege" class="form-control" id="siege" required>
                        </div>

                        <div class="mb-3">
                            <label for="nombre" class="form-label">Nombre de copie</label>
                            <input type="number" name="nombre" class="form-control" id="nombre" required>
                        </div>
                        <div class="mb-3">
                            <label for="enseignant" class="form-label">Enseignant</label>
                            <input type="text" name="enseignant" class="form-control" id="enseignant" required>
                        </div>
                        <div class="mb-3">
                            <label for="fileInput" class="form-label">Sélectionner un fichier :</label>
                            <input type="file" class="form-control" id="fileInput" name="file">
                        </div>

                        <div class="col-12">
                            <button type="submit" class="btn btn-warning shadow">
                                <i class="bi bi-send-fill"></i> Envoyer</button>
                        </div>
                    </form> {% endcomment %}
                    {% if messages %}
                        <div class="alert-messages">
                            {% for message in messages %}
                                <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                                    {{ message }}
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}
                    <form method="post" enctype="multipart/form-data" class="form-control" class=" p-4 shadow">
                        {% csrf_token %}
                        {{ form.as_p }}
                        <div class="form-group">
                            {% comment %} <input type="file" id="fileInput" name="dossier" webkitdirectory directory multiple /> {% endcomment %}
                            <input multiple type="file" name="dossier" id="id_dossier" class="form-control">
                        </div>
                        <button type="submit" class="btn btn-primary">Envoyer</button>
                    </form>
                    {% if message %}
                        <p>{{ message }}</p>
                    {% endif %}
                    <script>
                        document.getElementById('fileInput').addEventListener('change', function(event) {
                            let files = event.target.files;
                            let formData = new FormData();
                            for (let file of files) {
                                formData.append('dossier', file);
                            }
                            document.getElementById('uploadForm').onsubmit = function() {
                                for (let [key, value] of formData.entries()) {
                                    this.appendChild(new File([value], key));
                                }
                            }
                        });
                    </script>
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            var dateField = document.getElementById('date_field');
                            var now = new Date();
                            var formattedDate = now.toISOString().slice(0, 19).replace('T', ' ');
                            dateField.value = formattedDate;
                        });
                    </script>
                    <script>
                        var enseignants = [];
                        
                        document.addEventListener('DOMContentLoaded', function() {
                            fetch("{% url 'ScolaritePersonal:get_enseignant_details' %}")
                                .then(response => response.json())
                                .then(data => {
                                    enseignants = data;
                                });
                        });
                        </script>                        
                  </div>
                  
        </section>
                                           
</main><!-- End #main -->

{% endblock %}